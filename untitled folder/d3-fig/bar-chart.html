<!DOCTYPE html>
<meta charset="utf-8">
<style>

.axisWhite line{
  stroke: white;
}

.axisWhite path{
  stroke: white;
}

.axisWhite text{
  fill: white;
}

</style>
<script src="js/d3.v4.min.js"></script>
<body>
<div id="textDiv"></div>  

<script>
const data = [
  {name: 'Train-Pos', Pneumonia: 225,   Hernia: 291,   Prev_Sur: 617, Pleural_Effusion:546, Ascites:236, Atherosclerosis:490, Cardiomegaly:303, Atelectasis:553, Hydronephrosis:46,GB_Thickening:22,Pulmonary_Edema:74, Lymphadenopathy:371, Enlarged_Liver:69, Aortic_Aneurysm:91},
  {name: 'Train-Neg', Pneumonia: 1023, Hernia: 957,   Prev_Sur: 631,
Pleural_Effusion:702, Ascites:1012, Atherosclerosis:758, Cardiomegaly:945, Atelectasis:695, Hydronephrosis:1202,GB_Thickening:1226,Pulmonary_Edema:1174, Lymphadenopathy:877, Enlarged_Liver:1179, Aortic_Aneurysm:1157},
  {name: 'Val-Pos', Pneumonia: 53,   Hernia: 75,   Prev_Sur: 162,
Pleural_Effusion:127, Ascites:63, Atherosclerosis:130, Cardiomegaly:87, Atelectasis:138, Hydronephrosis:19,GB_Thickening:3,Pulmonary_Edema:20, Lymphadenopathy:113, Enlarged_Liver:17, Aortic_Aneurysm:29},
  {name: 'Val-Neg', Pneumonia: 259, Hernia: 237,   Prev_Sur: 150,
Pleural_Effusion:185, Ascites:249, Atherosclerosis:182, Cardiomegaly:225, Atelectasis:174, Hydronephrosis:293,GB_Thickening:309,Pulmonary_Edema:292, Lymphadenopathy:199, Enlarged_Liver:295, Aortic_Aneurysm:283}
];


const margin = { top: 10, right: 10, bottom: 30, left: 50 };
const width = 600 - margin.left - margin.right;
const height = 350 - margin.top - margin.bottom;


const svg = d3.select('body')
  .append('svg')
    .attr('width', width + margin.left + margin.right)
    .attr('height', height + margin.top + margin.bottom)
  .append('g')
    .attr('transform', `translate(${margin.left}, ${margin.top})`);


const xScale = d3.scaleBand()
  .domain(data.map(d => d.name))
  .range([0, width])
  .padding(0.2);
svg
  .append('g')
    .attr('transform', `translate(0, ${height})`)
    .attr("class", "axisWhite")
  .call(d3.axisBottom(xScale))
  .selectAll("text")
      .style("text-anchor", "middle")
      .style("font-size","2.2em")
      .style("font-family", "Raleway")
      .style("fill","white");

const yScale = d3.scaleLinear()
  .domain([0, 1000])
  .range([height, 0]);

svg
  .append('g')
  .attr("class", "axisWhite")
  .call(d3.axisLeft(yScale))
  .selectAll("text")
      .style("text-anchor", "right")
      .style("font-size","1.5em")
      .style("font-family", "Raleway")
      .style("fill","white");


function render (subject = 'math') {
  var div = document.getElementById("textDiv");  
  div.textContent = subject; 
  div.style.color = "Red";
  div.style.fontSize = "50px" ; 
  var text = div.textContent;
  const update = svg.selectAll('rect')
    // .data(data.filter(d => d[subject]), d => d.name); //filter out name with no data
    .data(data); // add all the data even if zero. Needed for transition

  update.exit()
    .remove();

  update
    .transition() // NEW
    .duration(500) // Also NEW
    .attr('y', d => yScale(d[subject]))
    .attr('height', d => height - yScale(d[subject]));


  update
    .enter()
    .append('rect')
    .style('fill', '#9BE7FF')
    .attr('x', d => xScale(d.name))
    .attr('width', d => xScale.bandwidth())
    .attr('y', d => yScale(d[subject]))
    .attr('height', d => height - yScale(d[subject]));

}

render('Pneumonia');

var _transitions = [
      {
        transitionForward: () => render("Hernia"),
        index: 1
      },
      {
        transitionForward: () => render("Prev_Sur"),
        index: 2
      },
      {
        transitionForward: () => render("Pleural_Effusion"),
        index: 3
      },
      {
        transitionForward: () => render("Ascites"),
        index: 4
      },
      {
        transitionForward: () => render("Atherosclerosis"),
        index: 5
      },
      {
        transitionForward: () => render("Cardiomegaly"),
        index: 6
      },
      {
        transitionForward: () => render("Atelectasis"),
        index: 7
      },
      {
        transitionForward: () => render("Hydronephrosis"),
        index: 8
      },
      {
        transitionForward: () => render("GB_Thickening"),
        index: 9
      },
      {
        transitionForward: () => render("Pulmonary_Edema"),
        index: 10
      },
      {
        transitionForward: () => render("Lymphadenopathy"),
        index: 11
      },
      {
        transitionForward: () => render("Enlarged_Liver"),
        index: 12
      },
      {
        transitionForward: () => render("Aortic_Aneurysm"),
        index: 13
      }

    ]

</script>
</body>
</html>
